{% load staticfiles %}
<!DOCTYPE html>
<html lang="zh">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="login">
    <meta name="author" content="lyw">
    <link href="{% static 'img/icon.png' %}" rel="icon">

		<title>课程点评网</title>

		<!-- Bootstrap core CSS -->
    <link href="{% static 'css/bootstrap.min.css' %}" type="text/css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.6.2/html5shiv.js"></script>
    <script src="../../docs-assets/js/respond.min.js"></script>
    <![endif]-->
	</head>

	<body>
    {% csrf_token %}
    <div class="container">
      <nav class="navbar" style="background-color:#DDDDDD;">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navcol">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">课程点评网</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="navcol">
          <!-- <ul class="nav navbar-nav">
            <li><a href="#">课程排行</a></li>
            <li><a href="#">课程交易</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">课程分类 <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="#">人文通识</a></li>
                <li><a href="#">社科通识</a></li>
                <li><a href="#">自然通识</a></li>
                <li class="divider"></li>
                <li><a href="#">必修课</a></li>
                <li class="divider"></li>
                <li><a href="#">任选课</a></li>
              </ul>
            </li>
          </ul> -->
          <ul class="nav navbar-nav navbar-right">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">{{ u.name }} <span class="badge" style="background-color:#FF7744 ;">{% if u.messageofcommentsuper_set.all.count %}{{ u.messageofcommentsuper_set.all.count }}{% endif %}</span></a>
              {% if u.messageofcommentsuper_set.all.count %}
              <ul class="dropdown-menu">
                {% for message in u.messageofcommentsuper_set.all %}
                <li><a href="/userpage/checksupermessage/{{ message.id }}/">{{ message.lecture_comment.lecture.course.name }}__{{ message.lecture_comment.lecture.professor.name }}<br/>
                {{ message.lecture_comment.content|truncatechars:30 }}
                <p style="text-align:right;">赞 + ({{ message.super_added }})</p></a></li>
                <li class="divider"></li>
                {% endfor %}
                <li style="text-align:center;">共 {{u.messageofcommentsuper_set.all.count}} 条</li>
              </ul>
              {% endif %}
            </li>
            <li><a href="/setpassword/">修改密码</a></li>
            <li><a href="/logout/">退出</a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </nav>

      <div class="row">
        <form class="col-sm-offset-4">
          <div class="form-group dropdown col-sm-5">
            <input type="text" class="form-control" id="search" autocomplete="off" placeholder="来这里找课！">
            <ul class="dropdown-menu" id="complete" style="width:90.7%;border-radius:0px;margin-top:-1px;margin-left:15px"></ul>
          </div>
          <button type="submit" id="submit" class="btn btn-default">搜索</button>
        </form>
      </div><!-- search form -->

      <!-- extra search -->
      <div class="modal fade" id="eSearch" tabindex="-1">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h4 class="modal-title"></h4>
            </div>
            <div class="modal-body"></div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary" data-dismiss="modal">确定</button>
            </div>
          </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
      </div><!-- /.modal -->

      <div class="row" style="margin-top:20px;">
        <div class="col-sm-6 col-sm-offset-1" style="border:solid 1px black;border-style:solid none;">
          <h3>猜你喜欢
          <p style="margin-top:-1.2em;text-align:right;">
          <a type="button" class="btn btn-default btn-xs" href="#">
            <span class="glyphicon glyphicon-chevron-left"></span>
          </a>
          <button type="button" class="btn btn-default btn-xs">
            <span class="glyphicon glyphicon-chevron-right"></span>
          </button>
          </p>
          </h3>
          {% for l in lectures %}
          <div class="panel panel-primary">
            <div class="panel-heading">
              <h3 class="panel-title"><a href="/lecture/{{ l.id }}/">{{ l.course.name }}</a><p style="margin-top:-1.2em;margin-bottom:0;text-align:right;white-space:pre;">{{ l.professor.name }}      {{ l.level }}</p></h3>
            </div>
            <div class="panel-body">
              {% for c in l.lecturecomment_set.all|slice:":1" %}
              <p>{{ c.content }}</p>
              <p style="text-align:right;white-space:pre;">{{ c.user.name }}    赞 ({{ c.super_number }})</p>
              {% empty %}
              <p>还没有评论！快来抢沙发</p>
              {% endfor %}
            </div>
          </div>
          {% endfor %}
        </div>
        <div class="col-sm-3 col-sm-offset-1">
          <div class="panel panel-danger">
            <div class="panel-heading">
              <h3 class="panel-title">系统成就</h3>
            </div>
            <div class="panel-body">
              <p>我们已经帮助交大同学{{ sys_achievement }}次了解课程</p>
            </div>
          </div>
          <div class="panel panel-info">
            <div class="panel-heading">
              <h3 class="panel-title">我的成就</h3>
            </div>
            <div class="panel-body">
              <p>我的影响因子：{{ user_influence_factor }}</p>
              <p>我的排名：{{ user_rank }}</p>
            </div>
          </div>
          <div class="panel panel-danger">
            <div class="panel-heading">
              <h3 class="panel-title">收藏的课</h3>
            </div>
            <div class="panel-body">
              {% for collectionrecord in u.userlecturecollection_set.all|slice:":3" %}
              <p><a href="/lecture/{{ collectionrecord.lecture.id }}/">{{ collectionrecord.lecture.course.name }}</a> {{ collectionrecord.lecture.professor.name }}</p>
              {% for c in collectionrecord.lecture.lecturecomment_set.all|slice:":1" %}
              <p>{{ c.content }}</p>
              <p style="text-align:right;white-space:pre;">{{ c.user.name }}    赞 ({{ c.super_number }})</p>
              {% empty %}
              <p>还没有评论！快来抢沙发</p>
              {% endfor %}
              {% empty %}
              <p>还没有收藏的课程。</p>
              <p>快去课程页面收藏喜欢的课吧！</p>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-10 col-sm-offset-1">
          <div class="panel panel-primary">
            <div class="panel-heading">
              <h3 class="panel-title">我的评论</h3>
            </div>
            <div class="panel-body">
              <p>
                总共{{ u.lecturecomment_set.all.count }}条评论。显示{% if u.lecturecomment_set.all.count < 3 %}{{ u.lecturecomment_set.all.count }}条。
                {% else %}3条。{% endif %}
              </p>
              <table class="table table-striped">
                <thead></thead>
                <tbody>
                  {% for comment in u.lecturecomment_set.all|dictsortreversed:"time"|slice:":3" %}
                  <tr>
                    <th>
                      {{ comment.user.name }}<br/>
                      {{ comment.lecture.course.name }}<br/>
                      {{ comment.lecture.professor.name }}
                    </th>
                    <th>
                      <p>{{ comment.content }}</p>
                      <ul class="breadcrumb">
                        <li style="margin-right:40%;">
                          {{ comment.time|date:"Y-m-d H:i:s" }}
                        </li>
                        <li>
                          赞 ({{ comment.super_number }})
                        </li>
                      </ul>
                      <p><br/></p>
                    </th>
                  </tr>
                  {% empty %}
                  <p>You haven't make a comment</p>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!--
      <div class="row">
        <div class="col-sm-5">
          <div class="panel panel-primary">
            <div class="panel-heading" style="text-align:center;">评分TOP10</div>
            <table class="table">
              <thead>
                <tr>
                  <th>排名</th> <th>课程名</th> <th>老师</th> <th>评分</th>
                </tr>
              </thead>
              <tbody id="rank1">
                {% for l in llevel %}
                <tr>
                  <td></td>
                  <td><a href="/lecture/{{ l.id }}/">{{ l.course.name }}</a></td>
                  <td>{{ l.professor.name }}</td>
                  <td>{{ l.level }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
        <div class="col-sm-5 col-sm-offset-2">
          <div class="panel panel-primary">
            <div class="panel-heading" style="text-align:center;">得分TOP10</div>
            <table class="table">
              <thead>
                <tr>
                  <th>排名</th> <th>课程名</th> <th>老师</th> <th>评分</th>
                </tr>
              </thead>
              <tbody id="rank2">
                {% for l in lstudentscore %}
                <tr>
                  <td></td>
                  <td><a href="/lecture/{{ l.id }}/">{{ l.course.name }}</a></td>
                  <td>{{ l.professor.name }}</td>
                  <td>{{ l.student_score }}</td>
                </tr>
                {% endfor %}
              </tbody>
          </table>
          </div>
        </div>
      </div>
      -->
    </div><!-- container -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="{% static 'js/jquery-1.10.2.min.js' %}"></script>
    <script src="{% static 'js/jquery-migrate-1.2.1.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/myjquery.js' %}"></script>
    <script src="{% static 'js/userpage.js' %}"></script>
	</body>
</html>